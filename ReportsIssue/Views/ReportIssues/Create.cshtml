@model ReportsIssue.Models.ReportIssueViewModel

<h2>Create a New Report Issue</h2>

<!-- Progress Bar -->
<div class="progress mb-4">
    <div id="progress-bar" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div>
</div>

<form asp-action="Create" asp-controller="ReportIssues" enctype="multipart/form-data">
    <div class="form-group">
        <label asp-for="Location" class="control-label">Location</label>
        <input asp-for="Location" class="form-control" />
        <span asp-validation-for="Location" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Category" class="control-label">Category</label>
        <select asp-for="Category" class="form-control" asp-items="@(new SelectList(new[] { "Sanitation", "Roads", "Other", "Environment", "Public Safety", "Accessibility", "Utilities and Energy", "Housing and Buildings", "Traffic and Transportation", "Parks and Recreation", "Noise", "Animal Control", "Education" }))"></select>
        <span asp-validation-for="Category" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Description" class="control-label">Description</label>
        <textarea asp-for="Description" class="form-control"></textarea>
        <span asp-validation-for="Description" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="MediaAttachment" class="control-label">Upload Attachment</label>
        <input type="file" asp-for="MediaAttachment" class="form-control" />
        <span asp-validation-for="MediaAttachment" class="text-danger"></span>
    </div>

    <button type="submit" class="btn btn-primary">Submit</button>
</form>

<a asp-action="Index" asp-controller="Home" class="btn btn-secondary mt-4">Back to Menu</a>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const progressBar = document.getElementById('progress-bar');
        const fields = ['Location', 'Category', 'Description', 'MediaAttachment'];
        const totalFields = fields.length;

        function updateProgressBar() {
            let filledFields = fields.filter(id => {
                const field = document.getElementById(id);
                if (field.type === 'file') {
                    return field.files.length > 0;
                }
                return field.value.trim() !== '';
            }).length;

            const progress = (filledFields / totalFields) * 100;
            progressBar.style.width = `${progress}%`;
            progressBar.setAttribute('aria-valuenow', progress);
        }

        fields.forEach(id => {
            document.getElementById(id).addEventListener('input', updateProgressBar);
        });

        document.getElementById('MediaAttachment').addEventListener('change', updateProgressBar);
    });
</script>
